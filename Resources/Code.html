<!DOCTYPE html>
<html>
<head>
    <title>Исходный код программы</title>
</head>
<body>
    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">LexicalAnalyser.cs</span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System.Collections.Generic;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System.Text.RegularExpressions;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">namespace lab1_compiler.Bar</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; public class LexicalToken</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int Code { get; set; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string Type { get; set; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string Value { get; set; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string Position { get; set; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; internal class LexicalAnalyzer</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Код</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">токенов</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">:</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">// 1 - Начало однострочного комментария (// или #)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 2 - Начало многострочного комментария /*</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">// 3 - </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Конец</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">многострочного</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">комментария</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> */</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 4 - </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Текст</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">комментария</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly Dictionary&lt;string, int&gt; _tokenTypes = new Dictionary&lt;string, int&gt;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { &quot;SingleLineCommentStart&quot;, 1 },</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { &quot;MultiLineCommentStart&quot;, 2 },</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { &quot;MultiLineCommentEnd&quot;, 3 },</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { &quot;CommentText&quot;, 4 }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public List&lt;LexicalToken&gt; Tokens { get; } = new List&lt;LexicalToken&gt;();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public List&lt;string&gt; Errors { get; } = new List&lt;string&gt;();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool errorReported = false;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Функция</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">нейтрализации</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">ошибок</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void NeutralizeErrors() =&gt; Errors.Clear();</span></span></span></p>

    <p>&nbsp;</p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">// Вспомогательный метод для регистрации первой ошибки</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">private void ReportError(string message)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!errorReported)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Errors.Add(message);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; errorReported = true;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Analyze(string text)</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Удаляем незначащие пробелы и табы перед началом комментариев на каждой строке</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">text = Regex.Replace(text, @&quot;^[ \t]+(?=(//|#|/\*))&quot;, &quot;&quot;, RegexOptions.Multiline);</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tokens.Clear();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Errors.Clear();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; errorReported = false;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int i = 0;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int line = 1;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int col = 1;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int length = text.Length;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool inString = false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char stringDelimiter = &#39;\0&#39;;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (i &lt; length)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char current = text[i];</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (current == &#39;\n&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col = 1;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inString = false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Строковые</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">литералы</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!inString &amp;&amp; (current == &#39;&quot;&#39; || current == &#39;\&#39;&#39;))</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inString = true;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringDelimiter = current;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (inString)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (current == stringDelimiter)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inString = false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (current == &#39;\\&#39; &amp;&amp; i + 1 &lt; length)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i += 2;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col += 2;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col++;</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Пропускаем остальные пробелы и табы</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">if (char.IsWhiteSpace(current) &amp;&amp; current != &#39;\n&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int startLine = line, startCol = col;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Однострочный</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">комментарий</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">или</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> #</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (current == &#39;/&#39; &amp;&amp; i + 1 &lt; length &amp;&amp; text[i + 1] == &#39;/&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EmitSingleLine(text, ref i, ref col, startLine, startCol, &quot;//&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (current == &#39;#&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EmitSingleLine(text, ref i, ref col, startLine, startCol, &quot;#&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Многострочный</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">комментарий</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> /* ... */</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (current == &#39;/&#39; &amp;&amp; i + 1 &lt; length &amp;&amp; text[i + 1] == &#39;*&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EmitMultiLine(text, ref i, ref col, ref line, startLine, startCol);</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Некорректное начало комментария: &quot;/&quot; не перед &quot;/&quot; или &quot;*&quot;</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">if (current == &#39;/&#39; &amp;&amp; i + 1 &lt; length &amp;&amp; text[i + 1] != &#39;/&#39; &amp;&amp; text[i + 1] != &#39;*&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReportError($&quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Неправильное</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">начало</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">комментария</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> &#39;/{text[i + 1]}&#39; at line {line}, col {col}&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Некорректное</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">закрытие</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> */ </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">вне</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">контекста</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (current == &#39;*&#39; &amp;&amp; i + 1 &lt; length &amp;&amp; text[i + 1] == &#39;/&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tokens.Add(new LexicalToken</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Code = _tokenTypes[&quot;MultiLineCommentEnd&quot;],</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type = &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Конец</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">многострочного</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">комментария</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Value = &quot;*/&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Position = $&quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Строка</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> {startLine}, </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Позиция</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> {startCol}&quot;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i += 2;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col += 2;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Остальное</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">пропускаем</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void EmitSingleLine(string text, ref int i, ref int col, int line, int colPos, string marker)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tokens.Add(new LexicalToken</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Code = _tokenTypes[&quot;SingleLineCommentStart&quot;],</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Type = &quot;Начало однострочного комментария&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Value = marker,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Position = $&quot;Строка {line}, Позиция {colPos}&quot;</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">});</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i += marker.Length;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col += marker.Length;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int contentStart = i;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (i &lt; text.Length &amp;&amp; text[i] != &#39;\n&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string content = text.Substring(contentStart, i - contentStart).Trim();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tokens.Add(new LexicalToken</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Code = _tokenTypes[&quot;CommentText&quot;],</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type = &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Текст</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">комментария</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Value = content,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Position = $&quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Строка</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> {line}, </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Позиция</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> {colPos + marker.Length}&quot;</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">});</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">}</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void EmitMultiLine(string text, ref int i, ref int col, ref int line, int startLine, int startCol)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tokens.Add(new LexicalToken</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Code = _tokenTypes[&quot;MultiLineCommentStart&quot;],</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Type = &quot;Начало многострочного комментария&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Value = &quot;/*&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Position = $&quot;Строка {startLine}, Позиция {startCol}&quot;</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">});</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i += 2;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col += 2;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int contentStart = i;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool closed = false;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (i &lt; text.Length)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (text[i] == &#39;\n&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col = 1;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (text[i] == &#39;*&#39; &amp;&amp; i + 1 &lt; text.Length &amp;&amp; text[i + 1] == &#39;/&#39;)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; closed = true;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col++;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string content = text.Substring(contentStart, i - contentStart).Trim();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tokens.Add(new LexicalToken</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Code = _tokenTypes[&quot;CommentText&quot;],</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Type = &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Текст</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">комментария</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Value = content,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Position = $&quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Строка</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> {startLine}, </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Позиция</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> {startCol + 2}&quot;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (closed)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tokens.Add(new LexicalToken</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Code = _tokenTypes[&quot;MultiLineCommentEnd&quot;],</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type = &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Конец</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">многострочного</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">комментария</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Value = &quot;*/&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Position = $&quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Строка</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> {line}, </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Позиция</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> {col}&quot;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i += 2;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col += 2;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReportError($&quot;Unterminated multi-line comment starting at line {startLine}, col {startCol}&quot;);</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">}</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p style="text-align:justify"><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">}</span></span></span></p>

    <p style="text-align:justify"><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">MainForm.cs</span></span></span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">using System;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">using System.Diagnostics;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">using System.Drawing;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">using System.Runtime.InteropServices;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">using System.Text.RegularExpressions;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">using System.Windows.Forms;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">using lab1_compiler.Bar;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">namespace lab1_compiler</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">{</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp; public partial class Compiler : Form</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;private readonly List&lt;float&gt; _defaultFontSizes = new List&lt;float&gt; { 8, 9, 10, 11, 12, 14, 16, 18, 20, 24 };</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly LexicalAnalyzer _lexer = new LexicalAnalyzer();</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Берём функции для элементов меню</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly FileManager _fileHandler;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly CorManager _corManager;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly RefManager _refManager;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">/// Ссылки на справочное руководство</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">private</span> <span style="font-family:&quot;Times New Roman&quot;,serif">const</span> <span style="font-family:&quot;Times New Roman&quot;,serif">string</span><span style="font-family:&quot;Times New Roman&quot;,serif"> _</span><span style="font-family:&quot;Times New Roman&quot;,serif">aboutPath</span><span style="font-family:&quot;Times New Roman&quot;,serif"> = @&quot;</span><span style="font-family:&quot;Times New Roman&quot;,serif">Resources</span><span style="font-family:&quot;Times New Roman&quot;,serif">\</span><span style="font-family:&quot;Times New Roman&quot;,serif">About</span><span style="font-family:&quot;Times New Roman&quot;,serif">.</span><span style="font-family:&quot;Times New Roman&quot;,serif">html</span><span style="font-family:&quot;Times New Roman&quot;,serif">&quot;;</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">private const string _helpPath = @&quot;Resources\Help.html&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private const string _taskPath = @&quot;Resources\Task.html&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private const string _grammaryPath = @&quot;Resources\Grammary.html&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private const string _cgrammaryPath = @&quot;Resources\CGrammary.html&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private const string _manalysisPath = @&quot;Resources\MAnalysis.html&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private const string _diagErrPath = @&quot;Resources\DiagErr.html&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private const string _testPath = @&quot;Resources\Test.html&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private const string _listLibraryPath = @&quot;Resources\ListLibrary.html&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private const string _codePath = @&quot;Resources\Code.html&quot;;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Compiler()</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeComponent();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeFontSizeComboBox();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileHandler = new FileManager(this);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager = new CorManager(richTextBox1);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager = new RefManager(_helpPath, _aboutPath, _taskPath, _grammaryPath, _cgrammaryPath, _manalysisPath, _diagErrPath, _testPath, _listLibraryPath, _codePath);</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">// Установка минимального размера (ширина, высота)</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">this</span><span style="font-family:&quot;Times New Roman&quot;,serif">.</span><span style="font-family:&quot;Times New Roman&quot;,serif">MinimumSize</span><span style="font-family:&quot;Times New Roman&quot;,serif"> = </span><span style="font-family:&quot;Times New Roman&quot;,serif">new</span> <span style="font-family:&quot;Times New Roman&quot;,serif">Size</span><span style="font-family:&quot;Times New Roman&quot;,serif">(450, 300);</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Изменили данные в окне ввода</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">richTextBox1.DragEnter += RichTextBox_DragEnter;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.DragDrop += RichTextBox_DragDrop;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.TextChanged += RichTextBox_TextChanged;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.VScroll += RichTextBox_VScroll;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolStripStatusLabel1.Text = &quot;Compiler успешно запущена&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.TextChanged += RichTextBox1_TextChanged;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void HighlightMatches(string pattern, Color color, FontStyle style)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (Match match in Regex.Matches(richTextBox1.Text, pattern))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.Select(match.Index, match.Length);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.SelectionColor = color;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.SelectionFont = new Font(richTextBox1.Font, style);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// статусная строка</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void RichTextBox1_TextChanged(object sender, EventArgs e)</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">{</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Запускаем лексический анализатор при изменении текста</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">_lexer.Analyze(richTextBox1.Text);</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int tokenCount = _lexer.Tokens.Count;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int errorCount = _lexer.Errors.Count;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">// Формируем сообщение в зависимости от результатов сканирования</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">if</span><span style="font-family:&quot;Times New Roman&quot;,serif"> (</span><span style="font-family:&quot;Times New Roman&quot;,serif">errorCount</span><span style="font-family:&quot;Times New Roman&quot;,serif"> == 0)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">toolStripStatusLabel</span><span style="font-family:&quot;Times New Roman&quot;,serif">1.</span><span style="font-family:&quot;Times New Roman&quot;,serif">Text</span><span style="font-family:&quot;Times New Roman&quot;,serif"> = $&quot;Сканирование выполнено успешно. Токенов: {</span><span style="font-family:&quot;Times New Roman&quot;,serif">tokenCount</span><span style="font-family:&quot;Times New Roman&quot;,serif">}&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">else</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">toolStripStatusLabel</span><span style="font-family:&quot;Times New Roman&quot;,serif">1.</span><span style="font-family:&quot;Times New Roman&quot;,serif">Text</span><span style="font-family:&quot;Times New Roman&quot;,serif"> = $&quot;Обнаружено ошибок: {</span><span style="font-family:&quot;Times New Roman&quot;,serif">errorCount</span><span style="font-family:&quot;Times New Roman&quot;,serif">}. Токенов: {</span><span style="font-family:&quot;Times New Roman&quot;,serif">tokenCount</span><span style="font-family:&quot;Times New Roman&quot;,serif">}&quot;;</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">}</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// НУМЕРАЦИИИЯ</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void RichTextBox_VScroll(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Синхронизация прокрутки между richTextBox1 и richTextBoxLineNumbers</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int verticalScrollPos = GetFirstVisibleLineNumber() * richTextBoxLineNumbers.Font.Height;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBoxLineNumbers.SelectionStart = richTextBoxLineNumbers.GetCharIndexFromPosition(new Point(0, verticalScrollPos));</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBoxLineNumbers.ScrollToCaret();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private int GetFirstVisibleLineNumber()</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">{</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Определяем первую видимую строку в </span><span style="font-family:&quot;Times New Roman&quot;,serif">richTextBox</span><span style="font-family:&quot;Times New Roman&quot;,serif">1</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">int firstVisibleCharIndex = richTextBox1.GetCharIndexFromPosition(new Point(0, 0));</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return richTextBox1.GetLineFromCharIndex(firstVisibleCharIndex);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void UpdateLineNumbers()</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int lineCount = richTextBox1.Lines.Length;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string lineNumbersText = &quot;&quot;;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; lineCount; i++)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;{</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lineNumbersText += (i + 1).ToString() + Environment.NewLine;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBoxLineNumbers.Text = lineNumbersText;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int firstVisibleLine = GetFirstVisibleLineNumber();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int verticalScrollPos = firstVisibleLine * richTextBoxLineNumbers.Font.Height;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBoxLineNumbers.Select(0, 0);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBoxLineNumbers.ScrollToCaret();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBoxLineNumbers.SelectionStart = richTextBoxLineNumbers.GetCharIndexFromPosition(new Point(0, verticalScrollPos));</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBoxLineNumbers.ScrollToCaret();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// РЕАЛИЗАЦИЯ ДРАГЭНДРОПА ПОФИКСИТЬ КАРТИНКУ</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void RichTextBox_DragEnter(object sender, DragEventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Проверяем, что перетаскивается файл</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (e.Data.GetDataPresent(DataFormats.FileDrop))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Effect = DragDropEffects.Copy; // Разрешаем копирование</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Effect = DragDropEffects.None; // Отклоняем другие типы данных</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void RichTextBox_DragDrop(object sender, DragEventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (e.Data.GetDataPresent(DataFormats.FileDrop))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string[] files = (string[])e.Data.GetData(DataFormats.FileDrop);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (files.Length &gt; 0)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string filePath = files[0];</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (IsTextFile(filePath))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Явно очищаем содержимое перед загрузкой нового файла</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox</span><span style="font-family:&quot;Times New Roman&quot;,serif">1.</span><span style="font-family:&quot;Times New Roman&quot;,serif">Clear</span><span style="font-family:&quot;Times New Roman&quot;,serif">();</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Загружаем содержимое файла и обновляем интерфейс</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _</span><span style="font-family:&quot;Times New Roman&quot;,serif">fileHandler</span><span style="font-family:&quot;Times New Roman&quot;,serif">.</span><span style="font-family:&quot;Times New Roman&quot;,serif">DragFile</span><span style="font-family:&quot;Times New Roman&quot;,serif">(</span><span style="font-family:&quot;Times New Roman&quot;,serif">filePath</span><span style="font-family:&quot;Times New Roman&quot;,serif">); // Передаем путь в метод</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">UpdateLineNumbers();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateWindowTitle();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show($&quot;Ошибка: {ex.Message}&quot;, &quot;Ошибка&quot;, MessageBoxButtons.OK, MessageBoxIcon.Error);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show(&quot;Только текстовые файлы (.txt, .cs, .cpp, .java)&quot;, &quot;Ошибка&quot;, MessageBoxButtons.OK, MessageBoxIcon.Warning);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool IsTextFile(string filePath)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string[] allowedExtensions = { &quot;.txt&quot;, &quot;.cs&quot;, &quot;.cpp&quot;, &quot;.java&quot;, &quot;.php&quot; };</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string extension = Path.GetExtension(filePath).ToLower();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return allowedExtensions.Contains(extension);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp; РИЧТЕКСТБОКС</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void RichTextBox_TextChanged(object? sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Отключаем Undo/Redo для стилей</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.PauseUndoTracking();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //ApplySyntaxHighlighting();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.ResumeUndoTracking();</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Обновление файла и интерфейса</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileHandler.UpdateFileContent(richTextBox1.Text);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateLineNumbers();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateWindowTitle();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string GetCurrentContent()</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return richTextBox1.Text;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void UpdateRichTextBox(string content)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (richTextBox1.InvokeRequired)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.Invoke(new Action(() =&gt; richTextBox1.Text = content));</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.Text = content;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void UpdateWindowTitle()</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (InvokeRequired)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Invoke(new Action(UpdateWindowTitle));</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Text = GetWindowTitle();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private string GetWindowTitle()</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var filePath = _fileHandler.CurrentFilePath;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var fileName = string.IsNullOrEmpty(filePath)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ? &quot;Новый файл.txt&quot;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : Path.GetFileName(filePath);</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var asterisk = _fileHandler.IsFileModified ? &quot;*&quot; : &quot;&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var pathInfo = string.IsNullOrEmpty(filePath)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ? &quot;&quot;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : $&quot; ({filePath})&quot;;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $&quot;Компилятор &mdash; {fileName}{asterisk}{pathInfo}&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// РАЗМЕР ШРИФТА</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void InitializeFontSizeComboBox()</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolStripFontSizeComboBox.ComboBox.DropDownStyle = ComboBoxStyle.DropDown;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolStripFontSizeComboBox.ComboBox.AutoCompleteMode = AutoCompleteMode.SuggestAppend;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Заполняем только стандартными размерами</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolStripFontSizeComboBox.ComboBox.Items.AddRange(_defaultFontSizes.Cast&lt;object&gt;().ToArray());</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Устанавливаем текущий размер шрифта</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolStripFontSizeComboBox.ComboBox.Text = richTextBox1.Font.Size.ToString();</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Подписка на события</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolStripFontSizeComboBox.ComboBox.KeyDown += FontSizeComboBox_KeyDown;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolStripFontSizeComboBox.ComboBox.TextChanged += (s, e) =&gt; ApplyFontSizeFromComboBox();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void FontSizeComboBox_KeyDown(object sender, KeyEventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (e.KeyCode == Keys.Enter)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ApplyFontSizeFromComboBox();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Handled = true;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.SuppressKeyPress = true;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void ApplyFontSizeFromComboBox()</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (float.TryParse(toolStripFontSizeComboBox.ComboBox.Text, out float newSize))</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">{</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Ограничиваем диапазон без добавления в список</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">newSize</span><span style="font-family:&quot;Times New Roman&quot;,serif"> = </span><span style="font-family:&quot;Times New Roman&quot;,serif">Math</span><span style="font-family:&quot;Times New Roman&quot;,serif">.</span><span style="font-family:&quot;Times New Roman&quot;,serif">Clamp</span><span style="font-family:&quot;Times New Roman&quot;,serif">(</span><span style="font-family:&quot;Times New Roman&quot;,serif">newSize</span><span style="font-family:&quot;Times New Roman&quot;,serif">, 1, 99);</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Обновляем шрифт</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">UpdateFontSize(richTextBox1, newSize);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateFontSize(richTextBoxLineNumbers, newSize);</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">// Обновляем текст без добавления в </span><span style="font-family:&quot;Times New Roman&quot;,serif">Items</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span style="font-family:&quot;Times New Roman&quot;,serif">toolStripFontSizeComboBox.ComboBox.Text = newSize.ToString();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void UpdateFontSize(RichTextBox rtb, float size)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (rtb.Font.Size != size)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rtb.Font = new Font(rtb.Font.FontFamily, size, rtb.Font.Style);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void SetComboBoxSelectedSize(float size)</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">{</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Просто устанавливаем текст, не добавляем новые элементы</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">toolStripFontSizeComboBox.ComboBox.Text = size.ToString();</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">}</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;</span><span style="font-family:&quot;Times New Roman&quot;,serif">summary</span><span style="font-family:&quot;Times New Roman&quot;,serif">&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// </span><span style="font-family:&quot;Times New Roman&quot;,serif">Bar</span><span style="font-family:&quot;Times New Roman&quot;,serif">/</span><span style="font-family:&quot;Times New Roman&quot;,serif">FileManager</span><span style="font-family:&quot;Times New Roman&quot;,serif">.</span><span style="font-family:&quot;Times New Roman&quot;,serif">cs</span><span style="font-family:&quot;Times New Roman&quot;,serif">, отвечает за вкладку Файл в меню приложения</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;<span style="font-family:&quot;Times New Roman&quot;,serif">/// &lt;/summary&gt;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void создатьToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileHandler.CreateNewFile();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void открытьToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_fileHandler.OpenFile();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void сохранитьToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileHandler.SaveFile();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void сохранитьКакToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileHandler.SaveAsFile();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void выходToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileHandler.Exit();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Bar/CorManager.cs, отвечает за вкладку Правка в меню приложения</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void отменитьToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Undo();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void повторитьToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">{</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _</span><span style="font-family:&quot;Times New Roman&quot;,serif">corManager</span><span style="font-family:&quot;Times New Roman&quot;,serif">.</span><span style="font-family:&quot;Times New Roman&quot;,serif">Redo</span><span style="font-family:&quot;Times New Roman&quot;,serif">();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Реализация отменить и повторить: по одному символу за нажатие кнопки</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">private void вырезатьToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Cut();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void копироватьToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Copy();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void вставитьToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Paste();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void удалитьToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Delete();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void выделитьВсеToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.SelectAll();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Bar/RefManager.cs, отвечает за вкладку Справка в меню приложения</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void вызовСправкиToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowHelp();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void оПрограммеToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowAbout();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Крупные кнопки интерфейса</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void toolStripButtonAdd_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileHandler.CreateNewFile();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void toolStripButtonOpen_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileHandler.OpenFile();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void toolStripButtonSave_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileHandler.SaveFile();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void toolStripButtonCancel_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Undo();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void toolStripButtonRepeat_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Redo();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void toolStripButtonCopy_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Copy();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void toolStripButtonCut_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Cut();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private void toolStripButtonInsert_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _corManager.Paste();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Запуск ПОКА ОСТАВИТЬ</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">/// &lt;/</span><span style="font-family:&quot;Times New Roman&quot;,serif">summary</span><span style="font-family:&quot;Times New Roman&quot;,serif">&gt;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Основной обработчик кнопки &quot;</span><span style="font-family:&quot;Times New Roman&quot;,serif">Play</span><span style="font-family:&quot;Times New Roman&quot;,serif">&quot;</span></p>

    <p style="text-align:justify">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:&quot;Times New Roman&quot;,serif">private void toolStripButtonPlay_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Очистка лидирующих пробелов перед комментариями</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CleanLeadingSpaces(richTextBox1);</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">// Анализ текста и обновление таблицы</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _</span><span style="font-family:&quot;Times New Roman&quot;,serif">lexer</span><span style="font-family:&quot;Times New Roman&quot;,serif">.</span><span style="font-family:&quot;Times New Roman&quot;,serif">Analyze</span><span style="font-family:&quot;Times New Roman&quot;,serif">(</span><span style="font-family:&quot;Times New Roman&quot;,serif">richTextBox</span><span style="font-family:&quot;Times New Roman&quot;,serif">1.</span><span style="font-family:&quot;Times New Roman&quot;,serif">Text</span><span style="font-family:&quot;Times New Roman&quot;,serif">);</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">dataGridView1.Rows.Clear();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (var token in _lexer.Tokens)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dataGridView1.Rows.Add(token.Code, token.Type, token.Value, token.Position);</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">// Сброс стилей (фон и цвет шрифта)</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">SetDefaultStyle</span><span style="font-family:&quot;Times New Roman&quot;,serif">();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Подсветка комментариев: зеленый цвет шрифта</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">HighlightComments</span><span style="font-family:&quot;Times New Roman&quot;,serif">(</span><span style="font-family:&quot;Times New Roman&quot;,serif">richTextBox</span><span style="font-family:&quot;Times New Roman&quot;,serif">1);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Подсветка первой ошибки: желтый фон</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">HighlightFirstError(richTextBox1);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void SetDefaultStyle()</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.SelectAll();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.SelectionBackColor = richTextBox1.BackColor;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.SelectionColor = richTextBox1.ForeColor;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.DeselectAll();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void CleanLeadingSpaces(RichTextBox rtb)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var lines = rtb.Lines;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; lines.Length; i++)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var line = lines[i];</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var m = Regex.Match(line, &quot;(?=//|#|/\\*)&quot;);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (m.Success)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int pos = m.Index;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string before = line.Substring(0, pos);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string after = line.Substring(pos);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (string.IsNullOrWhiteSpace(before))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lines[i] = after;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lines[i] = before.TrimEnd() + &quot; &quot; + after;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rtb.Lines = lines;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void HighlightComments(RichTextBox rtb)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var pattern = @&quot;(//.*?$|#.*?$|/\*.*?\*/?)&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach (Match m in Regex.Matches(rtb.Text, pattern, RegexOptions.Multiline | RegexOptions.Singleline))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rtb.Select(m.Index, m.Length);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rtb.SelectionColor = Color.Green;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rtb.DeselectAll();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void HighlightFirstError(RichTextBox rtb)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_lexer.Errors.Count == 0) return;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string err = _lexer.Errors[0];</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var m = Regex.Match(err, @&quot;line (\d+), col (\d+)&quot;);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!m.Success) return;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int line = int.Parse(m.Groups[1].Value);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int col = int.Parse(m.Groups[2].Value);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int idx = rtb.GetFirstCharIndexFromLine(line - 1) + (col - 1);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rtb.Select(idx, 1);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rtb.SelectionBackColor = Color.Yellow;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rtb.DeselectAll();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show(err, &quot;Ошибка анализа&quot;, MessageBoxButtons.OK, MessageBoxIcon.Warning);</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">}</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;</span><span style="font-family:&quot;Times New Roman&quot;,serif">summary</span><span style="font-family:&quot;Times New Roman&quot;,serif">&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Преобразует номер строки и столбца (начиная с 1) в индекс символа в строке.</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">/// &lt;/summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private int GetCharIndexFromLineAndColumn(string text, int line, int col)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string[] lines = text.Split(&#39;\n&#39;);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int index = 0;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; line - 1 &amp;&amp; i &lt; lines.Length; i++)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index += lines[i].Length + 1;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index += (col - 1);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return index;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Подсвечивает комментарии в richTextBox зеленым фоном.</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">/// Для однострочных комментариев используется шаблон: &quot;#&quot; и все до конца строки.</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Для многострочных комментариев &ndash; шаблон для тройных кавычек (&#39;&#39;&#39; или &quot;&quot;&quot;).</span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:&quot;Times New Roman&quot;,serif">/// &lt;/summary&gt;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private int GetCharIndexFromLineAndPosition(RichTextBox rtb, int line, int position)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (line &lt; 0 || line &gt;= rtb.Lines.Length) return -1;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int charIndex = 0;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; line; i++)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; charIndex += rtb.Lines[i].Length + 1; // учитываем символ переноса строки</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return charIndex + position;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ///</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void toolStripButtonHelp_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowHelp();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void toolStripButtonAbout_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowAbout();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void нейтрализацияОшибокToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_lexer.Errors.Count == 0) return;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string err = _lexer.Errors[0];</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string text = richTextBox1.Text;</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (err.StartsWith(&quot;Unterminated multi-line comment&quot;))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int openIdx = text.LastIndexOf(&quot;/*&quot;);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (openIdx &gt;= 0)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int pos = text.Length - 1;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char last = text[pos];</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (last == &#39;*&#39; || last == &#39;/&#39;)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.Text = text.Substring(0, pos) + &quot;*/&quot;;</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (!text.Contains(&quot;*/&quot;))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.AppendText(&quot;*/&quot;);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (!text.Contains(&quot;*/&quot;))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.AppendText(&quot;*/&quot;);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;else if (err.StartsWith(&quot;Invalid comment start&quot;))</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var match = Regex.Match(err, &quot;Invalid comment start &#39;/(.)&#39; at line (\\d+), col (\\d+)&quot;);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (match.Success)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int line = int.Parse(match.Groups[2].Value);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int col = int.Parse(match.Groups[3].Value);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int idx = richTextBox1.GetFirstCharIndexFromLine(line - 1) + (col - 1);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; richTextBox1.Text = text.Insert(idx, &quot;/&quot;);</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _lexer.NeutralizeErrors();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetDefaultStyle();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void постановкаЗадачиToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowTask();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void грамматикаToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowGrammar();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void классификацияГрамматикиToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowCGrammar();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void методАнализаToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowMAnalysis();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void диагностикаИНейтрализацияОшибокToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowDiagError();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void тестовыйПримерToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowTest();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void списокЛитературыToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowLibrary();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify">&nbsp;</p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void исходныйКодПрограммыToolStripMenuItem_Click(object sender, EventArgs e)</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _refManager.ShowCode();</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp; }</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">}</span></p>

    <p style="text-align:justify"><span style="font-family:&quot;Times New Roman&quot;,serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RefManager.cs</span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System.Diagnostics;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System.IO;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System.Windows.Forms;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">namespace lab1_compiler.Bar</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; internal class RefManager</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _helpFilePath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _aboutFilePath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _taskPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _grammaryPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _cgrammaryPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _manalysisPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _diagErrPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _testPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _listLibraryPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly string _codePath;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public RefManager(</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string helpPath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string aboutPath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string taskPath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string grammaryPath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string cgrammaryPath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string manalysisPath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string diagErrPath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string testPath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string listLibraryPath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string codePath)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _helpFilePath = helpPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _aboutFilePath = aboutPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _taskPath = taskPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _grammaryPath = grammaryPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _cgrammaryPath = cgrammaryPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _manalysisPath = manalysisPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _diagErrPath = diagErrPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _testPath = testPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _listLibraryPath = listLibraryPath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_codePath = codePath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Существующие</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">методы</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ShowHelp() =&gt; OpenHtmlFile(_helpFilePath, &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Справка</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ShowAbout() =&gt; OpenHtmlFile(_aboutFilePath, &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">О</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">программе</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;);</span></span></span></p>

    <p>&nbsp;</p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">// Новые методы для дополнительных ссылок</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ShowTask() =&gt; OpenHtmlFile(_taskPath, &quot;Постановка задачи&quot;);</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">public void ShowGrammar() =&gt; OpenHtmlFile(_grammaryPath, &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Грамматика</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ShowCGrammar() =&gt; OpenHtmlFile(_cgrammaryPath, &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Классификация</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">грамматики</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ShowMAnalysis() =&gt; OpenHtmlFile(_manalysisPath, &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Метод</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">анализа</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ShowDiagError() =&gt; OpenHtmlFile(_diagErrPath, &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Диагностика</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">ошибок</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ShowTest() =&gt; OpenHtmlFile(_testPath, &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Тестовый</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">пример</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ShowLibrary() =&gt; OpenHtmlFile(_listLibraryPath, &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Список</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">литературы</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ShowCode() =&gt; OpenHtmlFile(_codePath, &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Исходный</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">код</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;);</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void OpenHtmlFile(string filePath, string title)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!File.Exists(filePath))</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show($&quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Файл</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> {Path.GetFileName(filePath)} </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">не</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">найден</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">!&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Ошибка</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxButtons.OK,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBoxIcon.Error);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Process.Start(new ProcessStartInfo</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileName = filePath,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UseShellExecute = true</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show($&quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Ошибка</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">при</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">открытии</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">файла</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">: {ex.Message}&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; title,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBoxButtons.OK,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBoxIcon.Error);</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">}</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p style="text-align:justify"><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">}</span></span></span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">CorManager.cs</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System.Windows.Forms;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">namespace lab1_compiler.Bar</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; internal class CorManager</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly RichTextBox _editor;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool _isTyping = false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool _undoTrackingPaused;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void PauseUndoTracking() =&gt; _undoTrackingPaused = true;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ResumeUndoTracking() =&gt; _undoTrackingPaused = false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public CorManager(RichTextBox editor)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor = editor;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.KeyPress += Editor_KeyPress;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void Editor_KeyPress(object sender, KeyPressEventArgs e)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;if (!char.IsControl(e.KeyChar))</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Сохраняем текущую позицию курсора и выделение</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">int selectionStart = _editor.SelectionStart;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int selectionLength = _editor.SelectionLength;</span></span></span></p>

    <p>&nbsp;</p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">// Принудительно завершаем текущую операцию ввода</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _isTyping = true;</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">_editor.Undo();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.Redo();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _isTyping = false;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Восстанавливаем</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">позицию</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">курсора</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.SelectionStart = selectionStart;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.SelectionLength = selectionLength;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Прокрутка</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">к</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">курсору</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.ScrollToCaret();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Undo()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_undoTrackingPaused) return;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_editor.CanUndo)</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.Undo();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.Redo(); // Добавляем Redo для компенсации автоматических изменений</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.Undo(); // Корректная отмена</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.ScrollToCaret();</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">}</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Redo()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_editor.CanRedo)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.Redo();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.ScrollToCaret();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Cut()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_editor.SelectionLength &gt; 0)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.Cut();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Copy()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_editor.SelectionLength &gt; 0)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.Copy();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Paste() =&gt; _editor.Paste();</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Delete()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_editor.SelectionLength &gt; 0)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _editor.SelectedText = string.Empty;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void SelectAll() =&gt; _editor.SelectAll();</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">}</span></span></span></p>

    <p style="text-align:justify"><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">}</span></span></span></p>

    <p style="text-align:justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">FileManager.cs</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System.IO;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">using System.Windows.Forms;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">namespace lab1_compiler.Bar</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; internal class FileManager</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private string? _currentFilePath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private string _fileContent = string.Empty;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly Compiler _mainForm;</span></span></span></p>

    <p>&nbsp;</p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string? CurrentFilePath</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get =&gt; _currentFilePath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private set</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _currentFilePath = value;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateWindowTitle();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public bool IsFileModified { get; private set; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public FileManager(Compiler mainForm)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _mainForm = mainForm;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void UpdateFileContent(string content)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileContent = content;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsFileModified = true;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void CreateNewFile()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (CheckUnsavedChanges()) return;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileContent = string.Empty;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentFilePath = null;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsFileModified = true;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateEditorContent();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void OpenFile()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (CheckUnsavedChanges()) return;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using var openDialog = new OpenFileDialog();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (openDialog.ShowDialog() == DialogResult.OK)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentFilePath = openDialog.FileName;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileContent = System.IO.File.ReadAllText(CurrentFilePath);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsFileModified = false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateEditorContent();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void SaveFile()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (string.IsNullOrEmpty(CurrentFilePath))</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SaveAsFile();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileContent = _mainForm.GetCurrentContent();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.IO.File.WriteAllText(CurrentFilePath, _fileContent);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsFileModified = false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateWindowTitle();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void SaveAsFile()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using var saveDialog = new SaveFileDialog();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; saveDialog.Filter = &quot;</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Текстовые</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">файлы</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> (*.txt)|*.txt|</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Все</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">файлы</span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black"> (*.*)|*.*&quot;;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (saveDialog.ShowDialog() == DialogResult.OK)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentFilePath = saveDialog.FileName;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.IO.File.WriteAllText(CurrentFilePath, _fileContent);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsFileModified = false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateWindowTitle();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Exit()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!CheckUnsavedChanges())</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.Exit();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool CheckUnsavedChanges()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!IsFileModified) return false;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var result = MessageBox.Show(</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&quot;Сохранить изменения в текущем файле?&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Несохраненные изменения&quot;,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;MessageBoxButtons.YesNoCancel,</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBoxIcon.Warning</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">);</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch (result)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case DialogResult.Yes:</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SaveFile();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case DialogResult.Cancel:</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default:</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void UpdateEditorContent()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _mainForm?.UpdateRichTextBox(_fileContent);</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateWindowTitle();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void UpdateWindowTitle()</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _mainForm?.UpdateWindowTitle();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void SetFileModified(bool modified)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsFileModified = modified;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateWindowTitle();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void DragFile(string filePath)</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (CheckUnsavedChanges()) return;</span></span></span></p>

    <p>&nbsp;</p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentFilePath = filePath;</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _fileContent = File.ReadAllText(filePath); // </span></span></span><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">Читаем</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">как</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">обычный</span></span></span> <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">текст</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsFileModified = false;</span></span></span></p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">UpdateEditorContent();</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">&nbsp;&nbsp;&nbsp; }</span></span></span></p>

    <p style="text-align:justify"><span style="font-size:9.5pt"><span style="font-family:&quot;Cascadia Mono&quot;"><span style="color:black">}</span></span></span></p>
</body>
</html>
